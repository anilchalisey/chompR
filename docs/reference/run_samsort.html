<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Wrapper scripts for SAMtools functions — run_samsort • chompR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Wrapper scripts for SAMtools functions — run_samsort" />

<meta property="og:description" content="run_samsort sorts alignment (SAM/BAM/CRAM) files either by position
or read name using samtools sort.
run_samindex indexes sorted BAM files using
samtools index.
run_samview outputs all alignments matching the flag and
  region filters specified in either SAM or BAM format using
  samtools view.
run_samflagstat uses samtools flagstat to
calculate and print statistics from a BAM file.  It provides counts for 13
categories of reads: total, secondary, supplementary, duplicates, mapped,
paired in sequencing, read1, read2, properly paired, with itself and its mate
mapped, singletons, mate mapped to a different chromosome, with mate mapped
to a different chromosome with MAPQ&amp;gt;5." />

<meta property="og:image" content="https://anilchalisey.github.io/chompR/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chompR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/anilchalisey/chompR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrapper scripts for SAMtools functions</h1>
    <small class="dont-index">Source: <a href='https://github.com/anilchalisey/chompR/blob/master/R/run_samtools.R'><code>R/run_samtools.R</code></a></small>
    <div class="hidden name"><code>run_samsort.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>run_samsort</code> sorts alignment (SAM/BAM/CRAM) files either by position
or read name using <code>samtools sort</code>.</p>
<p><code>run_samindex</code> indexes sorted BAM files using
<code>samtools index</code>.</p>
<p><code>run_samview</code> outputs all alignments matching the flag and
  region filters specified in either SAM or BAM format using
  <code>samtools view</code>.</p>
<p><code>run_samflagstat</code> uses <code>samtools flagstat</code> to
calculate and print statistics from a BAM file.  It provides counts for 13
categories of reads: total, secondary, supplementary, duplicates, mapped,
paired in sequencing, read1, read2, properly paired, with itself and its mate
mapped, singletons, mate mapped to a different chromosome, with mate mapped
to a different chromosome with MAPQ&gt;5.</p>
    
    </div>

    <pre class="usage"><span class='fu'>run_samsort</span>(<span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>outformat</span> <span class='kw'>=</span> <span class='st'>"BAM"</span>,
  <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>memory</span> <span class='kw'>=</span> <span class='st'>"768M"</span>, <span class='kw'>sortbyname</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='st'>""</span>,
  <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>run_samindex</span>(<span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>bamfile</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='fu'>run_samview</span>(<span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>regions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>chrom.sizes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>include.flag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exclude.flag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>minQual</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>outformat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>outname</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>include.header</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>count</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>subsample</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>keep.paired</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep.proper.pair</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>remove.unmapped</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>remove.not.primary</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>remove.duplicates</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>remove.supplementary.alignment</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>remove.mitochondrial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>run_samflagstat</span>(<span class='kw'>bamfile</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>A vector of characters specifying the path to the bam files.</p></td>
    </tr>
    <tr>
      <th>samtools</th>
      <td><p>The path to samtools (if not in executable path).</p></td>
    </tr>
    <tr>
      <th>outformat</th>
      <td><p>String specifying output format: ('SAM'/'BAM'/'CRAM').  For
<code>run_samview</code> this should be SAM or 'BAM' only.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>A positive integer specifying the number of sorting and
compression threads</p></td>
    </tr>
    <tr>
      <th>memory</th>
      <td><p>String specifying maximum memory per thread; suffix K/M/G
recognized.</p></td>
    </tr>
    <tr>
      <th>sortbyname</th>
      <td><p>Boolean. If TRUE, reads are sorted by name. If FALSE,
reads are sorted by chromosome/position.</p></td>
    </tr>
    <tr>
      <th>suffix</th>
      <td><p>Suffix to add to the basename of the file e.g, _psort (for
position-sorted).</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>Boolean.  If TRUE, the input file is kept.  If FALSE, the input
file is deleted after a successful sort.</p></td>
    </tr>
    <tr>
      <th>bamfile</th>
      <td><p>Vector of characters specifying the path to sorted BAM files.</p></td>
    </tr>
    <tr>
      <th>regions</th>
      <td><p>Either path to a single BED file containing regions of
interest or regions defined in the format "RNAME:START[-END]".</p></td>
    </tr>
    <tr>
      <th>chrom.sizes</th>
      <td><p>Path to chromosome size file. Required if converting to
SAM format and including header.  If not available, then one will be
generated automatically from the existing header.  This is a tab-delimited
text file where each line contains the reference name in the first column
and length in the second column.</p></td>
    </tr>
    <tr>
      <th>include.flag</th>
      <td><p>Integer value.  Include output of alignments with any
bits set in this value present in the FLAG field.  See
<a href='https:://broadinstitute.github.io'>https:://broadinstitute.github.io</a>.</p></td>
    </tr>
    <tr>
      <th>exclude.flag</th>
      <td><p>Integer value.  Exclude output of alignments with any
bits set in this value present in the FLAG field.  See
<a href='https:://broadinstitute.github.io'>https:://broadinstitute.github.io</a>.</p></td>
    </tr>
    <tr>
      <th>minQual</th>
      <td><p>Skip alignments with MAPQ smaller than this value.</p></td>
    </tr>
    <tr>
      <th>outname</th>
      <td><p>Name for output file.</p></td>
    </tr>
    <tr>
      <th>include.header</th>
      <td><p>Boolean.  If TRUE header is included.  This option is
only necessary if outformat = "SAM" as header always included in "BAM".</p></td>
    </tr>
    <tr>
      <th>count</th>
      <td><p>Boolean.  If true, only count alignments instead of printing.</p></td>
    </tr>
    <tr>
      <th>subsample</th>
      <td><p>Float value - if set then subsampling is performed.  The
integer part is used to seed the random number generator and the part after
the decimal sets the fraction of reads to subsample.</p></td>
    </tr>
    <tr>
      <th>keep.paired</th>
      <td><p>Boolean.  If TRUE, keep paired reads only.</p></td>
    </tr>
    <tr>
      <th>keep.proper.pair</th>
      <td><p>Boolean.  If TRUE, keep concordantly paired reads
only.</p></td>
    </tr>
    <tr>
      <th>remove.unmapped</th>
      <td><p>Boolean.  If TRUE, remove unmapped reads.</p></td>
    </tr>
    <tr>
      <th>remove.not.primary</th>
      <td><p>Boolean.  If TRUE, remove reads mapped as secondary
alignments.</p></td>
    </tr>
    <tr>
      <th>remove.duplicates</th>
      <td><p>Boolean.  If TRUE, remove reads marked as optical or
PCR duplicates.</p></td>
    </tr>
    <tr>
      <th>remove.supplementary.alignment</th>
      <td><p>Boolean.  If TRUE, remove reads marked
as supplementary alignment.</p></td>
    </tr>
    <tr>
      <th>remove.mitochondrial</th>
      <td><p>Character string.  If set, this will remove reads
mapping to the mitochondrial genome.  The string should match the reference
name for the mitochindrial genome in the alignment file.  Examples include
"ChrM", "M" and "MT".</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>run_samsort</code> returns a sorted alignment file.</p>
<p><code>run_samindex</code> returns a BAI-format index file for sorted
BAM files.</p>
<p><code>run_samview</code> returns aligned reads according to the regions and
filters specified in BAM or SAM format.</p>
<p><code>run_samflagstat</code> returns a dataframe of alignment statistics.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>run_samsort</span>(<span class='kw'>file</span> <span class='kw'>=</span> <span class='st'>"HB1_sample.sam"</span>, <span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>,
            <span class='kw'>outformat</span> <span class='kw'>=</span> <span class='st'>"BAM"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> (<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>1</span>),
            <span class='kw'>memory</span> <span class='kw'>=</span> <span class='st'>"1G"</span>, <span class='kw'>sortbyname</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># }</span><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>run_samindex</span>(<span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>bamfile</span> <span class='kw'>=</span> <span class='st'>"HB1_sample.bam"</span>,
<span class='kw'>threads</span> <span class='kw'>=</span> (<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>1</span>))
<span class='co'># }</span><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>run_samview</span>(<span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='st'>"HB1_sample.bam"</span>, <span class='kw'>regions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>chrom.sizes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>include.flag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exclude.flag</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>minQual</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>outformat</span> <span class='kw'>=</span> <span class='st'>"BAM"</span>, <span class='kw'>outname</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>include.header</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>count</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> (<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() - <span class='fl'>1</span>), <span class='kw'>subsample</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>keep.paired</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep.proper.pair</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>remove.unmapped</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>remove.not.primary</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>remove.duplicates</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>remove.supplementary.alignment</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>remove.mitochondrial</span> <span class='kw'>=</span> <span class='st'>"ChrM"</span>)
<span class='co'># }</span><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>run_samflagstat</span>(<span class='kw'>samtools</span> <span class='kw'>=</span> <span class='st'>"samtools"</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>(),
                <span class='kw'>bamfile</span> <span class='kw'>=</span> <span class='st'>"HB1_sample.bam"</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/anilchalisey'>Anil Chalisey</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

